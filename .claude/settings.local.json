{
  "permissions": {
    "allow": [
      "Bash(**)",
      "Edit(**)",
      "Write(**)",
      "Read(**)",
      "Glob(**)",
      "Grep(**)",
      "Task(**)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfeat: 自動為租戶建立預設服務資料\n\n- 新增 initTestServices 方法\n- 為啟用的租戶自動建立 4 項預設服務（剪髮、染髮、護髮、洗髮）\n- 只在租戶沒有任何服務時才建立\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfeat: 自動為租戶建立預設員工資料\n\n- 新增 initTestStaffs 方法\n- 為啟用的租戶自動建立 3 位預設員工（Michael, Amy, Kevin）\n- 只在租戶沒有任何員工時才建立\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git commit:*)",
      "Bash(curl:*)",
      "Bash(node -e \"\nconst { Client } = require\\(''pg''\\);\nconst client = new Client\\({\n  connectionString: ''postgresql://postgres:RGQFnsDOCgEcqaKOdYbIxSFuZCjLcfeT@crossover.proxy.rlwy.net:28097/railway'',\n  ssl: { rejectUnauthorized: false }\n}\\);\n\nasync function run\\(\\) {\n  await client.connect\\(\\);\n  const res = await client.query\\(''SELECT id, username, name, email, status FROM tenants LIMIT 10''\\);\n  console.log\\(''現有店家帳號:''\\);\n  console.table\\(res.rows\\);\n  await client.end\\(\\);\n}\nrun\\(\\).catch\\(e => console.error\\(e\\)\\);\n\")",
      "Bash(node -e:*)",
      "Bash(git -C C:/soho/booking-platform commit -m \"$\\(cat <<''EOF''\nfeat: 優化 LINE Bot UI/UX，增加使用指引\n\n- 美化主選單：emoji 圖示、小提示區塊、樣式化按鈕\n- 新增步驟指示器（步驟 1/4 ~ 4/4）讓使用者了解流程\n- 改進服務選擇畫面，顯示分類、價格、時長等資訊\n- 改進員工選擇畫面，加入專業領域顯示\n- 新增歡迎訊息（首次追蹤）\n- 新增幫助訊息（關鍵字指引）\n- 新增取消流程確認對話框\n- 取消後顯示主選單而非純文字，方便操作\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C C:/soho/booking-platform commit -m \"$\\(cat <<''EOF''\nfix: 修復 SSE 認證問題，支援 query parameter 傳送 token\n\nEventSource API 無法設定 Authorization header，\n改為透過 query parameter 傳送 JWT token\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C C:/soho/booking-platform commit -m \"$\\(cat <<''EOF''\nfix: 加入 /sounds/** 到安全白名單\n\n通知音效檔案需要公開存取權限\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C C:/soho/booking-platform commit -m \"$\\(cat <<''EOF''\nfix: 移除外部音效檔案載入，改用 Web Audio API\n\n避免 404/500 錯誤影響頁面載入\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(# 建立新的 Rich Menu\nRICH_MENU_JSON=$\\(cat << ''EOFMENU''\n{\n  \"\"size\"\": {\"\"width\"\": 2500, \"\"height\"\": 843},\n  \"\"selected\"\": true,\n  \"\"name\"\": \"\"mk - 快捷選單\"\",\n  \"\"chatBarText\"\": \"\"點我展開選單\"\",\n  \"\"areas\"\": [\n    {\"\"bounds\"\": {\"\"x\"\": 0, \"\"y\"\": 0, \"\"width\"\": 833, \"\"height\"\": 421}, \"\"action\"\": {\"\"type\"\": \"\"postback\"\", \"\"label\"\": \"\"開始預約\"\", \"\"data\"\": \"\"action=start_booking\"\", \"\"displayText\"\": \"\"開始預約\"\"}},\n    {\"\"bounds\"\": {\"\"x\"\": 833, \"\"y\"\": 0, \"\"width\"\": 833, \"\"height\"\": 421}, \"\"action\"\": {\"\"type\"\": \"\"postback\"\", \"\"label\"\": \"\"我的預約\"\", \"\"data\"\": \"\"action=view_bookings\"\", \"\"displayText\"\": \"\"我的預約\"\"}},\n    {\"\"bounds\"\": {\"\"x\"\": 1666, \"\"y\"\": 0, \"\"width\"\": 834, \"\"height\"\": 421}, \"\"action\"\": {\"\"type\"\": \"\"postback\"\", \"\"label\"\": \"\"瀏覽商品\"\", \"\"data\"\": \"\"action=start_shopping\"\", \"\"displayText\"\": \"\"瀏覽商品\"\"}},\n    {\"\"bounds\"\": {\"\"x\"\": 0, \"\"y\"\": 421, \"\"width\"\": 833, \"\"height\"\": 422}, \"\"action\"\": {\"\"type\"\": \"\"postback\"\", \"\"label\"\": \"\"領取票券\"\", \"\"data\"\": \"\"action=view_coupons\"\", \"\"displayText\"\": \"\"領取票券\"\"}},\n    {\"\"bounds\"\": {\"\"x\"\": 833, \"\"y\"\": 421, \"\"width\"\": 833, \"\"height\"\": 422}, \"\"action\"\": {\"\"type\"\": \"\"postback\"\", \"\"label\"\": \"\"會員資訊\"\", \"\"data\"\": \"\"action=view_member_info\"\", \"\"displayText\"\": \"\"會員資訊\"\"}},\n    {\"\"bounds\"\": {\"\"x\"\": 1666, \"\"y\"\": 421, \"\"width\"\": 834, \"\"height\"\": 422}, \"\"action\"\": {\"\"type\"\": \"\"postback\"\", \"\"label\"\": \"\"聯絡店家\"\", \"\"data\"\": \"\"action=contact_shop\"\", \"\"displayText\"\": \"\"聯絡店家\"\"}}\n  ]\n}\nEOFMENU\n\\)\n\ncurl -s -X POST \"\"https://api.line.me/v2/bot/richmenu\"\"   -H \"\"Authorization: Bearer yAbXYSwqq+hrXOuWZOWxmfgEaFi5jsFO+s9XyBp8sTXcHoECaeup9qacRJt0bp4VX52ONX/ADbJV3cNwph22V1aSd/VX1agD+d1w9JyDzRCmUqOWctr3ZffWU3JRSTGNoCf0cYXjEpY/XannbXYg2QdB04t89/1O/w1cDnyilFU=\"\"   -H \"\"Content-Type: application/json\"\"   -d \"\"$RICH_MENU_JSON\"\")",
      "WebFetch(domain:is.gd)",
      "Bash(git -C C:/soho/booking-platform commit -m \"$\\(cat <<''EOF''\nfeat\\(test\\): 新增 F12 Console 自動監控 fixture，所有 UI 測試自動檢測瀏覽器錯誤\n\n- 新增 tests/fixtures.ts：Playwright 自定義 fixture，自動監控 pageerror、HTTP 500+、console.error\n- 新增 tests/20-f12-console-check.spec.ts：32 個測試覆蓋全部 31 個頁面的 F12 檢查\n- 更新 21 個 UI 測試檔案整合 F12 fixture（import from ''./fixtures''）\n- 過濾瀏覽器雜訊和預期 API 錯誤處理，只偵測真正的 BUG\n- 更新 CLAUDE.md：測試數量 558→590，新增 F12 監控文件\n- 全部 590 個測試通過\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "WebSearch",
      "Bash(git -C C:/soho/booking-platform commit -m \"$\\(cat <<''EOF''\nfix\\(ai\\): AI 客服改為通用行業範例，不再綁定美髮業\n\n- 移除系統提示詞中的美髮專用範例（剪髮、染髮、設計師等）\n- 改為通用範例，根據店家實際服務項目動態回答\n- 新增提醒：AI 必須根據店家資訊和服務項目回答，不自行編造\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "WebFetch(domain:booking-platform-production-1e08.up.railway.app)",
      "Bash(python -c \"\nimport smtplib\ntry:\n    server = smtplib.SMTP\\(''smtp.gmail.com'', 587, timeout=10\\)\n    server.starttls\\(\\)\n    server.login\\(''g0909095118@gmail.com'', ''subregojjmnbbjvr''\\)\n    print\\(''SMTP LOGIN SUCCESS''\\)\n    server.quit\\(\\)\nexcept Exception as e:\n    print\\(f''SMTP LOGIN FAILED: {e}''\\)\n\")",
      "Bash(python3 -c \"\nimport smtplib\ntry:\n    server = smtplib.SMTP\\(''smtp.gmail.com'', 587, timeout=10\\)\n    server.starttls\\(\\)\n    server.login\\(''g0909095118@gmail.com'', ''subregojjmnbbjvr''\\)\n    print\\(''SMTP LOGIN SUCCESS''\\)\n    server.quit\\(\\)\nexcept Exception as e:\n    print\\(f''SMTP LOGIN FAILED: {e}''\\)\n\")",
      "Bash(powershell -Command \"\ntry {\n    $smtp = New-Object System.Net.Mail.SmtpClient\\(''smtp.gmail.com'', 587\\)\n    $smtp.EnableSsl = $true\n    $smtp.Credentials = New-Object System.Net.NetworkCredential\\(''g0909095118@gmail.com'', ''subregojjmnbbjvr''\\)\n    $msg = New-Object System.Net.Mail.MailMessage\n    $msg.From = ''g0909095118@gmail.com''\n    $msg.To.Add\\(''g0909095118@gmail.com''\\)\n    $msg.Subject = ''SMTP Test''\n    $msg.Body = ''This is a test email from booking platform''\n    $smtp.Send\\($msg\\)\n    Write-Host ''EMAIL SENT SUCCESS''\n} catch {\n    Write-Host \"\"EMAIL FAILED: $_\"\"\n}\n\")",
      "Bash(git -C \"C:\\\\soho\\\\booking-platform\" commit -m \"$\\(cat <<''EOF''\nfeat: 新增前後端 API 契約驗證 — 靜態分析 + E2E 測試雙層防護\n\n兩層防護機制杜絕前後端欄位名不匹配的 bug：\n\n第 1 層：靜態分析 FIELD_MISMATCH（開發時即時抓到）\n- 擴展 scripts/audit-frontend-apis.js，從 HTML inline JS 提取 api.post/put 呼叫\n- 解析 Java DTO 欄位名和必填標記，自動比對前端送的欄位\n- 支援 ES6 shorthand、行內註解、巢狀物件、模板字串 URL\n- 21 組 API→DTO 對應規則，已發現 3 個真實的欄位靜默丟失問題\n\n第 2 層：E2E 契約測試 26-api-contract-validator.spec.ts（部署後驗證）\n- 22 個測試覆蓋所有 POST/PUT API\n- 用 request context 直接打 API，只驗證不回傳 400\n- beforeAll 取得真實 ID，用未來日期避免業務驗證干擾\n\nCLAUDE.md 新增「測試規範與最佳實踐」章節（可跨專案複用）：\n- 測試金字塔、靜態分析模式、契約測試設計模式\n- Playwright 最佳實踐、F12 監控模式、頁面健康驗證\n- 防護網測試清單、生產環境安全守則、CI/CD 整合建議\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")"
    ]
  }
}
